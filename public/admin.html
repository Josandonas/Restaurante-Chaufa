<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Administrativo - Restaurante Chaufa</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/admin/css/admin-modern.css">
    <link rel="stylesheet" href="/admin/css/admin-styles.css">
    <link rel="stylesheet" href="/admin/css/order-controls.css">
</head>
<body>
    <div class="login-container" id="loginContainer">
        <!-- √çcones Flutuantes Decorativos -->
        <div class="floating-icon">üçú</div>
        <div class="floating-icon">ü•ò</div>
        <div class="floating-icon">üç≤</div>
        <div class="floating-icon">ü•ü</div>
        <div class="floating-icon">üç±</div>
        <div class="floating-icon">ü•¢</div>
        
        <div class="login-box">
            <!-- Seletor de Idioma do Login (independente do admin) -->
            <div class="login-language-selector">
                <button class="login-lang-btn active" id="loginLangEs" onclick="window.loginI18n.changeLanguage('es')">üáßüá¥</button>
                <button class="login-lang-btn" id="loginLangPt" onclick="window.loginI18n.changeLanguage('pt')">üáßüá∑</button>
            </div>
            
            <div class="login-icon">
                <img src="/logos_imagens_app/logo.png" alt="La Casa del Chaufa">
            </div>
            <h1 data-i18n-login="welcome">Bem-vindo!</h1>
            <p class="login-subtitle" data-i18n-login="adminPanel">La Casa del Chaufa - Painel Administrativo</p>
            
            <div id="loginError"></div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label data-i18n-login="email">Email</label>
                    <input type="email" id="loginEmail" required placeholder="seu@email.com" autocomplete="email">
                </div>
                
                <div class="form-group">
                    <label data-i18n-login="password">Senha</label>
                    <div style="position: relative;">
                        <input type="password" id="loginPassword" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password" style="padding-right: 45px;">
                        <button type="button" id="toggleLoginPassword" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; padding: 5px; display: flex; align-items: center; justify-content: center; color: #666; transition: color 0.3s;" aria-label="Mostrar senha">
                            <svg id="eyeIconLogin" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="remember-me">
                    <input type="checkbox" id="rememberMe">
                    <label for="rememberMe" data-i18n-login="rememberMe">Manter-me conectado por 30 dias</label>
                </div>
                
                <button type="submit" class="btn btn-primary">
                    <span data-i18n-login="loginButton">Entrar no Painel</span>
                </button>
                
                <a href="/" class="btn-back-to-menu">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span data-i18n-login="backToMenu">Voltar ao Card√°pio</span>
                </a>
            </form>

            <div class="login-footer" data-i18n-login="peruvianFood">
                Comida Peruana Aut√™ntica üáµüá™
            </div>
        </div>
    </div>

    <div class="admin-container" id="adminContainer">
        <div class="admin-header">
            <div class="admin-header-content">
                <h1 data-i18n="adminTitle">üçΩÔ∏è Painel Administrativo - La Casa del Chaufa</h1>
                <div style="display: flex; gap: 15px; align-items: center;">
                    <div class="language-selector">
                        <button class="language-btn active" id="langPt" onclick="window.app.changeLanguage('pt')">üáßüá∑ PT</button>
                        <button class="language-btn" id="langEs" onclick="window.app.changeLanguage('es')">üá™üá∏ ES</button>
                    </div>
                    
                    <!-- Bolha de Perfil do Usu√°rio -->
                    <div class="user-profile-container">
                        <button class="user-profile-btn" id="userProfileBtn" onclick="window.userController.toggleUserMenu()">
                            <img id="userAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Crect fill='%23e0e0e0' width='100' height='100'/%3E%3Ccircle cx='50' cy='35' r='15' fill='%23999'/%3E%3Cpath d='M 30 70 Q 50 55 70 70' fill='%23999'/%3E%3C/svg%3E" alt="Avatar" class="user-avatar">
                            <span id="userEmailDisplay" class="user-email">usuario@email.com</span>
                            <svg class="dropdown-arrow" width="12" height="12" viewBox="0 0 12 12" fill="none">
                                <path d="M2 4L6 8L10 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                        </button>
                        
                        <!-- Dropdown Menu -->
                        <div class="user-dropdown-menu" id="userDropdownMenu">
                            <div class="user-menu-header">
                                <img id="userAvatarMenu" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Crect fill='%23e0e0e0' width='100' height='100'/%3E%3Ccircle cx='50' cy='35' r='15' fill='%23999'/%3E%3Cpath d='M 30 70 Q 50 55 70 70' fill='%23999'/%3E%3C/svg%3E" alt="Avatar" class="user-avatar-large">
                                <div class="user-info">
                                    <span id="userNameMenu" class="user-name">Nome do Usu√°rio</span>
                                    <span id="userEmailMenu" class="user-email-small">usuario@email.com</span>
                                </div>
                            </div>
                            <div class="user-menu-divider"></div>
                            <button class="user-menu-item" onclick="window.userController.openUploadPhotoModal()">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M10 4V16M4 10H16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                <span data-i18n="changePhoto">Mudar Foto de Perfil</span>
                            </button>
                            <button class="user-menu-item" id="changePasswordBtnMenu" onclick="window.userController.openPasswordModal()">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M5 10V7C5 4.79086 6.79086 3 9 3H11C13.2091 3 15 4.79086 15 7V10M6 10H14C15.1046 10 16 10.8954 16 12V16C16 17.1046 15.1046 18 14 18H6C4.89543 18 4 17.1046 4 16V12C4 10.8954 4.89543 10 6 10Z" stroke="currentColor" stroke-width="1.5"/>
                                </svg>
                                <span data-i18n="changePassword">Alterar Senha</span>
                            </button>
                            <button class="user-menu-item" id="manageUsersBtn" onclick="window.location.href='/users.html'" style="display: none;">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M13 7C13 8.65685 11.6569 10 10 10C8.34315 10 7 8.65685 7 7C7 5.34315 8.34315 4 10 4C11.6569 4 13 5.34315 13 7Z" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M5 17C5 14.2386 7.23858 12 10 12C12.7614 12 15 14.2386 15 17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                    <circle cx="15" cy="7" r="2" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M17 14C17.5 13.5 18.5 13 19 13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                <span>Gerenciar Usu√°rios</span>
                            </button>
                            <div class="user-menu-divider"></div>
                            <button class="user-menu-item user-menu-logout" onclick="window.authController.openLogoutModal()">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M13 3H16C17.1046 3 18 3.89543 18 5V15C18 16.1046 17.1046 17 16 17H13M8 7L4 11M4 11L8 15M4 11H14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                <span data-i18n="logout">Sair</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="admin-nav-wrapper">
            <div class="admin-nav-container">
                <div class="admin-nav">
                    <div class="admin-nav-content">
                        <button class="tab-btn active" data-tab="lista" data-i18n="tabList">üìã Pratos em Lista</button>
                        <button class="tab-btn" data-tab="destaques" data-i18n="tabFeatured">‚≠ê Pratos em Destaque</button>
                        <button class="tab-btn" data-tab="categorias" data-i18n="tabCategories">üìÇ Categorias</button>
                        <button class="tab-btn" data-tab="cambio" data-i18n="exchangeRate">üí± C√¢mbio Real</button>
                    </div>
                </div>
                <button class="btn-add-dish" id="contextualAddBtn">
                    <span id="contextualAddText">‚ûï Adicionar Prato</span>
                </button>
            </div>
        </div>

        <div class="admin-content">
            <div class="tab-content active" id="tab-lista">
                <div class="card">
                    <h2 class="card-title" data-i18n="tabList">Pratos em Lista</h2>
                    
                    <!-- Barra de Busca e Filtros -->
                    <div class="search-filter-bar">
                        <div class="search-box">
                            <input type="text" id="searchLista" placeholder="Buscar pratos..." class="search-input">
                            <span class="search-icon">üîç</span>
                        </div>
                        <select id="filterCategoriaLista" class="filter-select">
                            <option value="">Todas as categorias</option>
                        </select>
                    </div>
                    
                    <div class="table-container">
                        <table id="listaTable">
                            <thead>
                                <tr>
                                    <th data-i18n="name">Nome</th>
                                    <th data-i18n="priceBrl">Pre√ßo (R$)</th>
                                    <th data-i18n="priceBob">Precio (Bs.)</th>
                                    <th data-i18n="status">Status</th>
                                    <th data-i18n="actions">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div id="paginationLista"></div>
                </div>
            </div>

            <div class="tab-content" id="tab-destaques">
                <div class="card">
                    <h2 class="card-title" data-i18n="tabFeatured">Pratos em Destaque</h2>
                    
                    <!-- Barra de Busca e Filtros -->
                    <div class="search-filter-bar">
                        <div class="search-box">
                            <input type="text" id="searchDestaques" placeholder="Buscar pratos..." class="search-input">
                            <span class="search-icon">üîç</span>
                        </div>
                        <select id="filterCategoriaDestaques" class="filter-select">
                            <option value="">Todas as categorias</option>
                        </select>
                    </div>
                    
                    <div class="table-container">
                        <table id="destaquesTable">
                            <thead>
                                <tr>
                                    <th data-i18n="image">Imagem</th>
                                    <th data-i18n="name">Nome</th>
                                    <th data-i18n="priceBrl">Pre√ßo (R$)</th>
                                    <th data-i18n="priceBob">Precio (Bs.)</th>
                                    <th data-i18n="order">Ordem</th>
                                    <th data-i18n="status">Status</th>
                                    <th data-i18n="actions">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div id="paginationDestaques"></div>
                </div>
            </div>

            <div class="tab-content" id="tab-categorias">
                <div class="card">
                    <h2 class="card-title" data-i18n="tabCategories">üìÇ Categorias</h2>
                    
                    <!-- Barra de Busca -->
                    <div class="search-filter-bar">
                        <div class="search-box">
                            <input type="text" id="searchCategories" placeholder="Buscar categorias..." class="search-input">
                            <span class="search-icon">üîç</span>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table id="categoriesTable">
                            <thead>
                                <tr>
                                    <th data-i18n="order">Ordem</th>
                                    <th data-i18n="namePt">Nome (PT)</th>
                                    <th data-i18n="nameEs">Nome (ES)</th>
                                    <th data-i18n="status">Status</th>
                                    <th data-i18n="actions">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="categoriesTableBody"></tbody>
                        </table>
                    </div>
                    <div id="paginationCategorias"></div>
                </div>
            </div>

            <div class="tab-content" id="tab-cambio">
                <div class="card">
                    <h2 class="card-title"><span data-i18n="exchangeRate">C√¢mbio Real</span></h2>
                    
                    <div style="max-width: 600px; margin: 0 auto;">
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 30px;">
                            <p style="color: #666; margin-bottom: 15px; line-height: 1.6;" data-i18n="exchangeDescription">
                                Configure a taxa de c√¢mbio de <strong>Bolivianos (BOB)</strong> para <strong>Reais (BRL)</strong>. 
                                Esta taxa ser√° usada para calcular automaticamente os pre√ßos em reais baseados nos pre√ßos em bolivianos.
                            </p>
                            <p style="color: #666; font-size: 0.9em; line-height: 1.6;" data-i18n="exchangeExample">
                                <strong>Exemplo:</strong> Se a taxa √© 1.75, um prato de Bs. 125.00 custar√° R$ 71.43 (125 √∑ 1.75)
                            </p>
                        </div>

                        <div class="form-group">
                            <label for="taxa-cambio" style="font-size: 1.1em; margin-bottom: 10px; display: block;">
                                <span data-i18n="newRate">Nova Taxa</span> (1 BOB = ? BRL)
                            </label>
                            <input 
                                type="text" 
                                id="taxa-cambio" 
                                placeholder="0.750000"
                                style="font-size: 1.2em; text-align: center; font-weight: 600;"
                                inputmode="decimal"
                            >
                            <small style="display: block; margin-top: 8px; color: #666;" data-i18n="exchangeInputHint">
                                M√°ximo 6 casas decimais. Use ponto (.) como separador decimal.
                            </small>
                        </div>

                        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span style="color: #1976d2; font-weight: 600;" data-i18n="lastRegisteredValue">
                                        √öltimo Valor Registrado:
                                    </span>
                                    <span id="ultimo-valor-cambio" style="color: #1976d2; font-weight: 700; font-size: 1.1em;">
                                        Carregando...
                                    </span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span style="color: #1976d2; font-weight: 600;">
                                        <span data-i18n="lastUpdate">√öltima Atualiza√ß√£o</span>:
                                    </span>
                                    <span id="ultima-atualizacao-cambio" style="color: #1976d2;">
                                        Carregando...
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div style="margin-top: 30px;">
                            <button 
                                type="button" 
                                id="btn-recalcular-precos" 
                                class="btn btn-primary" 
                                style="width: 100%; padding: 16px; font-size: 1.1em; background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);"
                            >
                                üîÑ <span data-i18n="recalculatePrices">Recalcular Pre√ßos</span>
                            </button>
                        </div>

                        <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 8px; border-left: 4px solid #ffc107;">
                            <p style="color: #856404; margin: 0; line-height: 1.6;" data-i18n="exchangeWarning">
                                <strong>‚ö†Ô∏è Aten√ß√£o:</strong> Ao recalcular, a nova taxa ser√° salva e todos os valores em BRL ser√£o 
                                substitu√≠dos pelo c√°lculo: <code style="background: #fff; padding: 2px 6px; border-radius: 4px;">Pre√ßo BOB √∑ Taxa de C√¢mbio</code>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="dishModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Adicionar Prato</h2>
                <button class="modal-close" onclick="window.dishController.closeDishModal()">√ó</button>
            </div>
            <form id="dishForm">
                <div class="modal-body">
                    <input type="hidden" id="dishId">
                    <input type="hidden" id="dishTipo">
                    
                    <!-- Se√ß√£o: Informa√ß√µes B√°sicas -->
                    <div class="form-section">
                        <div class="form-section-title">üìù Informa√ß√µes B√°sicas</div>
                        
                        <div class="form-group-full">
                            <label>Nome em Portugu√™s *</label>
                            <input type="text" id="nomePt" required placeholder="Ex: Arroz Chaufa de Frango">
                        </div>

                        <div class="form-group-full">
                            <label>Nombre en Espa√±ol *</label>
                            <input type="text" id="nomeEs" required placeholder="Ej: Arroz Chaufa de Pollo">
                        </div>

                        <div class="form-group-full">
                            <label>Categoria</label>
                            <select id="categoriaId">
                                <option value="">Sem categoria</option>
                            </select>
                        </div>
                    </div>

                    <!-- Se√ß√£o: Descri√ß√µes -->
                    <div class="form-section">
                        <div class="form-section-title">üìÑ Descri√ß√µes</div>
                        
                        <div class="form-group-full">
                            <label>Descri√ß√£o em Portugu√™s</label>
                            <textarea id="descricaoPt" placeholder="Descreva o prato em portugu√™s..."></textarea>
                        </div>

                        <div class="form-group-full">
                            <label>Descripci√≥n en Espa√±ol</label>
                            <textarea id="descricaoEs" placeholder="Describe el plato en espa√±ol..."></textarea>
                        </div>
                    </div>

                    <!-- Se√ß√£o: Pre√ßos -->
                    <div class="form-section">
                        <div class="form-section-title">üí∞ Pre√ßos</div>
                        
                        <div class="form-grid-2">
                            <div class="form-group-full">
                                <label>Pre√ßo em Reais (R$) *</label>
                                <input type="number" step="0.01" id="precoBrl" required placeholder="0.00">
                            </div>
                            <div class="form-group-full">
                                <label>Precio en Bolivianos (Bs.) *</label>
                                <input type="number" step="0.01" id="precoBob" required placeholder="0.00">
                            </div>
                        </div>
                    </div>

                    <!-- Se√ß√£o: Imagem -->
                    <div class="form-section">
                        <div class="form-section-title">üì∏ Imagem do Prato (Opcional)</div>
                        
                        <div class="form-group-full">
                            <label>Imagem do Prato</label>
                            <div class="image-upload-container">
                                <input type="file" id="imagem" accept="image/*">
                                
                                <!-- Box de Upload -->
                                <div class="image-upload-box" id="uploadBox" onclick="document.getElementById('imagem').click()">
                                    <div class="upload-icon">üì∏</div>
                                    <div class="upload-text">Clique para selecionar uma imagem</div>
                                    <div class="upload-hint">JPG, PNG ou WEBP (m√°x. 5MB)</div>
                                </div>

                                <!-- Preview da Imagem -->
                                <div class="image-preview-container" id="imagePreviewContainer">
                                    <img id="imagePreview" class="image-preview" src="" alt="Preview">
                                    <div class="image-preview-overlay">
                                        <button type="button" class="image-change-btn" onclick="document.getElementById('imagem').click()">
                                            üîÑ Trocar Imagem
                                        </button>
                                    </div>
                                    <button type="button" class="image-remove-btn" id="removeImageBtn" onclick="window.dishController.removeImage()">
                                        √ó
                                    </button>
                                    <div class="image-info" id="imageInfo"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Campo ordem oculto - gerenciado automaticamente pelos bot√µes ‚ñ≤‚ñº -->
                    <input type="hidden" id="ordem" value="0">

                    <!-- Toggle de Disponibilidade -->
                    <div class="toggle-container">
                        <span class="toggle-icon">üçΩÔ∏è</span>
                        <span class="toggle-label" id="toggleLabel">Prato Dispon√≠vel</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="ativo" checked onchange="updateToggleLabel()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="window.dishController.closeDishModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">üíæ Salvar Prato</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="passwordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üîë Alterar Senha</h2>
                <button class="modal-close" onclick="window.userController.closePasswordModal()">√ó</button>
            </div>
            <form id="passwordForm">
                <div class="modal-body">
                    <div class="form-group-full">
                        <label>Senha Atual *</label>
                        <div style="position: relative;">
                            <input type="password" id="senhaAtual" required minlength="6" placeholder="Digite sua senha atual" autocomplete="current-password" style="padding-right: 45px;">
                            <button type="button" class="toggle-password" data-target="senhaAtual" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; padding: 5px; display: flex; align-items: center; justify-content: center; color: #666; transition: color 0.3s;" aria-label="Mostrar senha">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="form-group-full">
                        <label>Nova Senha *</label>
                        <div style="position: relative;">
                            <input type="password" id="novaSenha" required minlength="6" placeholder="Digite a nova senha" autocomplete="new-password" style="padding-right: 45px;">
                            <button type="button" class="toggle-password" data-target="novaSenha" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; padding: 5px; display: flex; align-items: center; justify-content: center; color: #666; transition: color 0.3s;" aria-label="Mostrar senha">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="form-group-full">
                        <label>Confirmar Nova Senha *</label>
                        <div style="position: relative;">
                            <input type="password" id="confirmarSenha" required minlength="6" placeholder="Confirme a nova senha" autocomplete="new-password" style="padding-right: 45px;">
                            <button type="button" class="toggle-password" data-target="confirmarSenha" style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; padding: 5px; display: flex; align-items: center; justify-content: center; color: #666; transition: color 0.3s;" aria-label="Mostrar senha">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="window.userController.closePasswordModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">üîí Alterar Senha</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Categoria -->
    <div class="modal" id="categoryModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 id="categoryModalTitle">Adicionar Categoria</h2>
                <button class="modal-close" onclick="window.categoryController.closeCategoryModal()">√ó</button>
            </div>
            <form id="categoryForm">
                <div class="modal-body">
                    <input type="hidden" id="categoryId">
                    
                    <div class="form-group-full">
                        <label>Nome em Portugu√™s *</label>
                        <input type="text" id="categoryNomePt" required placeholder="Ex: Chaufas (Arroz Chaufa)">
                    </div>

                    <div class="form-group-full">
                        <label>Nome em Espanhol *</label>
                        <input type="text" id="categoryNomeEs" required placeholder="Ej: Chaufas">
                    </div>

                    <!-- Campo ordem oculto - gerenciado automaticamente pelos bot√µes ‚ñ≤‚ñº -->
                    <input type="hidden" id="categoryOrdem" value="0">

                    <div class="toggle-container">
                        <span class="toggle-icon">üìÇ</span>
                        <span class="toggle-label">Categoria Ativa</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="categoryAtivo" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="window.categoryController.closeCategoryModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">üíæ Salvar Categoria</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o de Exclus√£o -->
    <div class="modal" id="deleteConfirmModal">
        <div class="logout-modal-content">
            <div class="logout-modal-header">
                <div class="logout-icon">‚ö†Ô∏è</div>
                <h2 data-i18n="confirmDelete">Confirmar Exclus√£o</h2>
            </div>
            <div class="logout-modal-body">
                <p class="logout-message" id="deleteConfirmMessage">Tem certeza que deseja excluir este item?</p>
                <p class="logout-submessage" data-i18n="deleteWarning">Esta a√ß√£o n√£o pode ser desfeita</p>
            </div>
            <div class="logout-modal-actions">
                <button type="button" class="btn btn-secondary" onclick="window.app.closeDeleteModal()" data-i18n="cancelButton">
                    ‚ùå Cancelar
                </button>
                <button type="button" class="btn btn-danger" onclick="window.app.confirmDelete()" data-i18n="confirmButton">
                    üóëÔ∏è Excluir
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o de Rec√°lculo -->
    <div class="modal" id="recalcularConfirmModal" onclick="if(event.target === this) window.configController.closeRecalcularModal()">
        <div class="logout-modal-content">
            <div class="logout-modal-header">
                <div class="logout-icon">üîÑ</div>
                <h2>Confirmar Rec√°lculo de Pre√ßos</h2>
            </div>
            <div class="logout-modal-body">
                <p class="logout-message">Tem certeza que deseja recalcular todos os pre√ßos em BRL baseado na taxa atual?</p>
                <p class="logout-submessage">Esta a√ß√£o atualizar√° todos os pratos do card√°pio.</p>
            </div>
            <div class="logout-modal-actions">
                <button type="button" class="btn btn-secondary" onclick="window.configController.closeRecalcularModal()">
                    ‚ùå Cancelar
                </button>
                <button type="button" class="btn btn-primary" onclick="window.configController.confirmarRecalcular()">
                    üîÑ Recalcular
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Logout -->
    <div class="modal" id="logoutModal">
        <div class="logout-modal-content">
            <div class="logout-modal-header">
                <div class="logout-icon">üëã</div>
                <h2 data-i18n="confirmLogout">Confirmar Sa√≠da</h2>
            </div>
            <div class="logout-modal-body">
                <p class="logout-message" data-i18n="logoutMessage">Tem certeza que deseja sair?</p>
                <p class="logout-submessage" data-i18n="logoutSubmessage">Voc√™ precisar√° fazer login novamente para acessar o painel</p>
            </div>
            <div class="logout-modal-actions">
                <button type="button" class="btn btn-secondary" onclick="window.authController.closeLogoutModal()" data-i18n="cancelButton">
                    ‚ùå Cancelar
                </button>
                <button type="button" class="btn btn-danger" onclick="window.authController.confirmLogout()" data-i18n="logoutButton">
                    üö™ Sair
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Upload de Foto -->
    <div class="modal" id="uploadPhotoModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 data-i18n="changePhoto">Mudar Foto de Perfil</h2>
                <button class="modal-close" onclick="window.userController.closeUploadPhotoModal()">√ó</button>
            </div>
            <div class="modal-body" style="text-align: center; padding: 30px;">
                <div style="margin-bottom: 20px;">
                    <img id="photoPreview" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Crect fill='%23e0e0e0' width='100' height='100'/%3E%3Ccircle cx='50' cy='35' r='15' fill='%23999'/%3E%3Cpath d='M 30 70 Q 50 55 70 70' fill='%23999'/%3E%3C/svg%3E" alt="Preview" 
                         style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; border: 4px solid #E74C3C; margin: 0 auto;">
                </div>
                <input type="file" id="photoInput" accept="image/*" style="display: none;">
                <button type="button" class="btn btn-primary" onclick="document.getElementById('photoInput').click()">
                    üì∑ <span data-i18n="selectPhoto">Selecionar Foto</span>
                </button>
                <p style="margin-top: 15px; color: #666; font-size: 0.9em;">
                    <span data-i18n="photoHint">Tamanho m√°ximo: 5MB. Formatos: JPG, PNG, GIF, WEBP</span>
                </p>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="window.userController.closeUploadPhotoModal()">
                    <span data-i18n="cancelButton">Cancelar</span>
                </button>
                <button type="button" class="btn btn-success" onclick="window.userController.handlePhotoUpload()" id="uploadPhotoBtn">
                    ‚úÖ <span data-i18n="savePhoto">Salvar Foto</span>
                </button>
            </div>
        </div>
    </div>

    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>

    <!-- Container de Notifica√ß√µes Toast -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Orquestrador Principal -->
    <script type="module" src="/js/app.js"></script>
    
    <!-- Handlers de Eventos -->
    <script type="module">
        import formHandlers from '/js/handlers/FormHandlers.js';
        import clickHandlers from '/js/handlers/ClickHandlers.js';
        import tabHandlers from '/js/handlers/TabHandlers.js';
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                formHandlers.init();
                clickHandlers.init();
                tabHandlers.init();
                initPasswordToggles();
            });
        } else {
            formHandlers.init();
            clickHandlers.init();
            tabHandlers.init();
            initPasswordToggles();
        }

        // Inicializar toggles de visibilidade de senha
        function initPasswordToggles() {
            // Toggle para campo de login
            const toggleLoginBtn = document.getElementById('toggleLoginPassword');
            const loginPasswordInput = document.getElementById('loginPassword');
            const eyeIconLogin = document.getElementById('eyeIconLogin');

            if (toggleLoginBtn && loginPasswordInput) {
                toggleLoginBtn.addEventListener('click', () => {
                    const isPassword = loginPasswordInput.type === 'password';
                    loginPasswordInput.type = isPassword ? 'text' : 'password';
                    
                    // Trocar √≠cone
                    if (isPassword) {
                        // Olho fechado (senha vis√≠vel)
                        eyeIconLogin.innerHTML = `
                            <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                            <line x1="1" y1="1" x2="23" y2="23"></line>
                        `;
                    } else {
                        // Olho aberto (senha oculta)
                        eyeIconLogin.innerHTML = `
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        `;
                    }
                });
            }

            // Toggle para campos do modal de senha
            const togglePasswordBtns = document.querySelectorAll('.toggle-password');
            togglePasswordBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const targetId = btn.getAttribute('data-target');
                    const input = document.getElementById(targetId);
                    const svg = btn.querySelector('svg');
                    
                    if (input) {
                        const isPassword = input.type === 'password';
                        input.type = isPassword ? 'text' : 'password';
                        
                        // Trocar √≠cone
                        if (isPassword) {
                            // Olho fechado (senha vis√≠vel)
                            svg.innerHTML = `
                                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                                <line x1="1" y1="1" x2="23" y2="23"></line>
                            `;
                            btn.setAttribute('aria-label', 'Ocultar senha');
                        } else {
                            // Olho aberto (senha oculta)
                            svg.innerHTML = `
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            `;
                            btn.setAttribute('aria-label', 'Mostrar senha');
                        }
                    }
                });
            });
        }
    </script>
</body>
</html>
